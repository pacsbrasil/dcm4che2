<!-- Calls all of the templates, in order (if given) from the named meta-data,
     with the given template name.
     Types of templates:
       Name ends in .js - include as script element
       Name ends in .xhtml - include literal
       Otherwise - call template as named element.
     @param from is the metadata map to call a template from.
     @param mode  is the type of call to make.
     Any provided body can be used to pass parameters using xsl:with-param.
  -->
<ui:component xmlns:ui="http://java.sun.com/jsf/facelets" 
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:c="http://java.sun.com/jstl/core"
   xmlns:x="http://www.dcm4che.org/xero/jsf"
   xmlns:fn="http://java.sun.com/jsp/jstl/functions"
>
   <c:forEach var="callTemplateItem" items="#{x:sorted(from,mode)}">
     <c:choose>
       <c:when test="#{callTemplateItem[mode]==null}"></c:when>
       <c:when test="#{fn:endsWith(callTemplateItem[mode],'.js')}">
         <script type="text/ecmascript" src="#{callTemplateItem[mode]}"> </script>
       </c:when>
       <c:when test="#{fn:endsWith(callTemplateItem[mode],'.xhtml')}">
         <ui:include src="#{callTemplateItem[mode]}" />
       </c:when>
       <c:otherwise test="#{callTemplateItem[mode]!=null}">
         <xsl:call-template name="#{callTemplateItem[mode]}"><ui:insert /></xsl:call-template>
       </c:otherwise>
     </c:choose>
   </c:forEach>
</ui:component>