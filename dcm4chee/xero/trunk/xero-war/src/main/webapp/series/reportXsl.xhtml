<x:xsl
   pageConfig="#{PageConfig.series.report}"
   xmlns:x="http://www.dcm4che.org/xero/jsf"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:m="http://www.dcm4che.org/xero/metadata/series/report"
   m:includeXsl="/series/reportXsl.xhtml"
>
<!-- Display available reports. -->
<x:template name="reportView" m:body="reportView" m:body.priority="750">
  <xsl:for-each select="$docNode/se:results/se:patient/se:study/se:series/se:report">
   <xsl:variable name="name" select="@conceptMeaning" />
   <xsl:variable name="curSOP" select="@SOPInstanceUID" />
   <xsl:variable name="firstSOP" select="($docNode/se:results/se:patient/se:study/se:series/se:report[@conceptMeaning=$name or count(@conceptMeaning)=0]/@SOPInstanceUID)[1]" />
   <xsl:message>Founda report view to add: <xsl:value-of select="$name" /></xsl:message>
   <xsl:if test="$firstSOP = $curSOP" >
    <span>
       <a target="imageFrame">
          <xsl:attribute name="href">/xero/report/report.seam?cid=<xsl:value-of select='$cid' />&amp;patientId=<xsl:value-of select="ancestor-or-self::*/@PatientID" />&amp;objectUID=<xsl:value-of select="@SOPInstanceUID"/></xsl:attribute>
       <xsl:value-of select="@conceptMeaning" />
       <xsl:if test="@conceptMeaning='' or count(@conceptMeaning)=0">
       Report
       </xsl:if>	        
       </a>
       <xsl:if test="@completion!=''">
       <xsl:value-of select="@completion" /> <br />
      </xsl:if>
       <xsl:if test="@verification!=''">
       <xsl:value-of select="@verification" /><br />
       </xsl:if>
    </span>
    <br />
   </xsl:if>
 </xsl:for-each>
</x:template>

</x:xsl>