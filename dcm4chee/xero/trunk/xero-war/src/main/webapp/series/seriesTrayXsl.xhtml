<?xml version="1.0" encoding="UTF-8"?>
<ui:fragment xmlns:ui="http://java.sun.com/jsf/facelets" 
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:se="http://www.dcm4chee.org/xero/search/study/"
>
<xsl:variable name="docName" select="/documents/series"/>
<ui:include src="seriesVars.xhtml" />

<xsl:template match="/" >
<html xmlns="http://www.w3.org/1999/xhtml">
<head>    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Xero Series 5</title>
</head>
<body style="background: black; color: white; ">
    <xsl:if test="/documents/debug='true'">
       docName=<xsl:value-of select="$docName"/> <br />
       #children patientNode=<xsl:value-of select="count($patientNode)" /><br />
       #children studyNode=<xsl:value-of select="count($studyNode)" /><br />
       studyUID=<xsl:value-of select="$studyUID" /><br />
       seriesUID=<xsl:value-of select="$seriesUID" /><br />
       @conversationId=<xsl:value-of select="/documents/@conversationId" /><br />
       cid=<xsl:value-of select="$cid" /><br />
    </xsl:if>
    <xsl:value-of select="$docNode/se:results/se:patient/@PatientsName" /> <br />
    <xsl:value-of select="$docNode/se:results/se:patient/@PatientID" /> <br />
    <xsl:value-of select="$docNode/se:results/se:patient/se:study/@StudyDescription" /> <br />
    <xsl:for-each select="$docNode/se:results/se:patient/se:study/se:series">
      <xsl:sort select="@SeriesNumber" />
      <span xml:space="preserve"><xsl:value-of select="@SeriesNumber" />
        <xsl:value-of select="@SeriesDescription" />
        <xsl:value-of select="@NumberofSeriesRelatedInstances" />
     </span>
      <center>
         <a target="imageFrame">
           <xsl:attribute name="href">../image/image.seam?cid=<xsl:value-of select="$cid"/>&amp;StudyInstanceUID=<xsl:value-of select="se:image/ancestor-or-self::*[@StudyInstanceUID]/@StudyInstanceUID" />&amp;SeriesInstanceUID=<xsl:value-of select="se:image/ancestor-or-self::*[@SeriesInstanceUID]/@SeriesInstanceUID" /></xsl:attribute>
           <img>
            <xsl:attribute name="src">/wado?requestType=WADO&amp;studyUID=<xsl:value-of select="se:image/ancestor-or-self::*[@StudyInstanceUID]/@StudyInstanceUID" />&amp;seriesUID=<xsl:value-of select="se:image/ancestor-or-self::*[@SeriesInstanceUID]/@SeriesInstanceUID" />&amp;objectUID=<xsl:value-of select="se:image/@SOPInstanceUID"/>&amp;rows=128</xsl:attribute>
           </img>
         </a>
      </center>
    </xsl:for-each>
</body>
</html>
</xsl:template>

</xsl:stylesheet>
</ui:fragment>
