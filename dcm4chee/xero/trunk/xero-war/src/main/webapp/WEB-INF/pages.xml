<pages>

  <page view-id="/tabs/tabsFrame.xhtml">
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/tabs/tabs.xhtml">
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/search/search.xhtml" action="#{SearchPageAction.search}">
    <navigation from-action="#{SearchPageAction.search}">
      <rule if-outcome="Add">
         <redirect view-id="/cycle/cycleFrame.seam" />
      </rule>
      <rule if-outcome="View">
         <redirect view-id="/study/patientFrame.xhtml">
           <param name="StudyUID" value="#{studySelection[0]}" />
         </redirect>
      </rule>
      <rule if-outcome="success">
         <render view-id="/search/search.xhtml" />
      </rule>
    </navigation>
  </page>

  <page view-id="/cycle/cycleFrame.xhtml" action="#{CyclePageAction.cycle}">
    <navigation>
      <rule if-outcome="Remove">
         <render view-id="/cycle/cycleFrame.xhtml" />
      </rule>
      <rule if-outcome="success">
         <render view-id="/cycle/cycleFrame.xhtml" />
      </rule>
    </navigation>
  </page>
  
  <page view-id="/cycle/cycle.xhtml">
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/cycle/patient.xhtml">
    <param name="pid" value="#{DisplayStudyLevel.pid}" />
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/study/patientFrame.xhtml" action="#{CyclePageAction.ensureStudyPresent}">
    <param name="pid" value="#{DisplayStudyLevel.pid}" />
    <param name="studyUID" value="#{DisplayStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{DisplayStudyLevel.seriesUID}" />
  </page>
  
  <page view-id="/study/displayFrame.xhtml"> 
    <param name="pid" value="#{DisplayStudyLevel.pid}" />
    <param name="studyUID" value="#{DisplayStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{DisplayStudyLevel.seriesUID}" />
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/study/study.xhtml">
    <param name="pid" value="#{DisplayStudyLevel.pid}" />
    <param name="studyUID" value="#{DisplayStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{DisplayStudyLevel.seriesUID}" />
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/series/seriesTray.xhtml">
    <param name="studyUID" value="#{DisplayStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{DisplayStudyLevel.seriesUID}" />
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/js/js.xhtml">
    <param name="jsEnabled" value="#{JavaScriptModel.javaScriptEnabled}" />
  </page>
  
  <page view-id="/report/report.xhtml">
    <param name="pid" value="#{ActionStudyLevel.pid}" />
    <param name="studyUID" value="#{ActionStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{ActionStudyLevel.seriesUID}" />
    <param name="objectUID" value="#{ActionStudyLevel.objectUID}" />
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/image/image.xhtml">
    <param name="pid" value="#{DisplayStudyLevel.pid}" />
    <param name="studyUID" value="#{DisplayStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{DisplayStudyLevel.seriesUID}" />
    <param name="mode" value="#{DisplayMode.mode}" />
    <param name="applyLevel" value="#{DisplayMode.applyLevelStr}" />
    <param name="counter" value="#{DisplayMode.counter}" />
    <param name="xslt" value="#{DisplayMode.xslt}" />
    <param name="debug" value="#{DebugMode.debug}" />
  
    <!-- To be removed into an action item -->
    <begin-conversation join="true" />
  </page>
  
  <page view-id="/image/action/*">
    <param name="pid" value="#{ActionStudyLevel.pid}" />
    <param name="studyUID" value="#{ActionStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{ActionStudyLevel.seriesUID}" />
    <param name="objectUID" value="#{ActionStudyLevel.objectUID}" />
    <param name="frame" value="#{ActionStudyLevel.frame}" />
    <param name="mode" value="#{DisplayMode.mode}" />
    <param name="xslt" value="#{DisplayMode.xslt}" />
    <param name="applyLevel" value="#{DisplayMode.applyLevelStr}" />
    <begin-conversation join="true" />
  </page>

  <page view-id="/image/action/Mode.xhtml" action="#{DisplayMode.action}">
    <navigation>
      <redirect view-id="/image/image.xhtml" />
    </navigation>
  </page>
  
  <page view-id="/image/action/SelectGsps.xhtml" action="#{SelectGsps.action}">
    <param name="gsps" value="#{SelectGsps.gsps}" />
    <navigation>
      <redirect view-id="/image/image.xhtml" />
    </navigation>
  </page>
  
  <page view-id="/image/action/WindowLevel.xhtml" action="#{WindowLevel.action}">
    <param name="windowWidth" value="#{WindowLevel.windowWidth}" />
    <param name="windowCenter" value="#{WindowLevel.windowCenter}" />
    <navigation>
      <redirect view-id="/image/image.xhtml" />
    </navigation>
  </page>
  
  <page view-id="/image/action/Navigate.xhtml" action="#{NavigateAction.action}">
    <param name="position" value="#{NavigateAction.position}" />
    <param name="dir" value="#{NavigateAction.dir}" />
    <navigation>
      <redirect view-id="/image/image.xhtml" />
    </navigation>
  </page>
  
  <page view-id="/image/action/Layout.xhtml" action="#{LayoutAction.action}">
    <param name="layout" value="#{LayoutAction.layout}" />
    <navigation>
      <redirect view-id="/image/image.xhtml" />
    </navigation>
  </page>
  
  <page view-id="/image/action/ZoomPan.xhtml" action="#{ZoomPan.action}">
    <param name="relZoom" value="#{ZoomPan.relZoom}" />
    <param name="panX" value="#{ZoomPan.panX}" />
    <param name="panY" value="#{ZoomPan.panY}" />
    
    <param name="rows" value="#{ZoomPan.rows}" />
    <param name="columns" value="#{ZoomPan.columns}" />
    <param name="topLeft" value="#{ZoomPan.topLeft}" />
    <param name="bottomRight" value="#{ZoomPan.bottomRight}" />
    
    <param name="size" value="#{ZoomPan.presentationSizeMode}" />
    <navigation>
      <redirect view-id="/image/image.xhtml" />
    </navigation>
  </page>
  
  <page view-id="/series/action/*">
    <!-- TODO Change this to use the ActionStudyLevel once the display level is modified for multi-study and to use the action/display study level info -->
    <param name="pid" value="#{DisplayStudyLevel.pid}" />
    <param name="studyUID" value="#{DisplayStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{DisplayStudyLevel.seriesUID}" />

    <begin-conversation join="true" />
  </page>
  
  <page view-id="/series/action/SelectKo.xhtml" action="#{SelectKo.action}">
    <param name="pid" value="#{ActionStudyLevel.pid}" />
    <param name="studyUID" value="#{ActionStudyLevel.studyUID}" />
    <param name="seriesUID" value="#{ActionStudyLevel.seriesUID}" />

    <param name="koUID" value="#{SelectKo.koUid}" />
    <navigation>
      <redirect view-id="/study/displayFrame.xhtml" />
    </navigation>
  </page>

</pages>