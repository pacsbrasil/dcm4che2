<?xml version="1.0" encoding="UTF-8"?>
<ui:fragment xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:m="http://www.dcm4chee.org/xero/metadata/display"
  m:xsl="imageXsl.xsl"
>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:se="http://www.dcm4chee.org/xero/search/study/"
   xmlns="http://www.w3.org/1999/xhtml">
   
<xsl:variable name="docName" select="/documents/images" />

<ui:include src="imageVars.xhtml" />

<xsl:include href="imageToolbarXsl.xsl" />

<xsl:include href="baseImageXsl.xsl" />

<ui:fragment>
<xsl:template name="contentTypeMeta">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" xmlns="http://www.w3.org/1999/xhtml"/>
</xsl:template>
</ui:fragment>

<xsl:template match="/"><html style="background: black; color: white; ">
  <head>
    <xsl:call-template name="contentTypeMeta" />
    <xsl:call-template name="cineMeta" />
    <title>Xero Image Frame</title>
  </head>
<body style="background: black; color: white;">
  <xsl:if test="/documents/debug='true'">
     docName=<xsl:value-of select="$docName" /><br />
     imageUID=<xsl:value-of select="$imageUID" /> <br />
     imagePrevUID=<xsl:value-of select="$imagePrevUID" /><br />
     imageNextUID=<xsl:value-of select="$imageNextUID" /><br />
  </xsl:if>

  <xsl:call-template name="baseImage" />
  <xsl:call-template name="imageToolbar" />
  
  <xsl:call-template name="cinePrefetch" />
  
  <link>
     <xsl:attribute name="rel">prefetch</xsl:attribute>
     <xsl:attribute name="href">/wado?requestType=WADO&amp;studyUID=<xsl:value-of select="$imageNode/ancestor-or-self::*[@StudyInstanceUID]/@StudyInstanceUID"/>&amp;seriesUID=<xsl:value-of select="$imageNode/ancestor-or-self::*[@SeriesInstanceUID]/@SeriesInstanceUID"/>&amp;objectUID=<xsl:value-of select="$imageNextUID"/>&amp;rows=512</xsl:attribute>
  </link>
  <link>
     <xsl:attribute name="rel">prefetch</xsl:attribute>
     <xsl:attribute name="href">/wado?requestType=WADO&amp;studyUID=<xsl:value-of select="$imageNode/ancestor-or-self::*[@StudyInstanceUID]/@StudyInstanceUID"/>&amp;seriesUID=<xsl:value-of select="$imageNode/ancestor-or-self::*[@SeriesInstanceUID]/@SeriesInstanceUID"/>&amp;objectUID=<xsl:value-of select="$imagePrevUID"/>&amp;rows=512</xsl:attribute>
  </link>
  
</body>

</html>
</xsl:template>

</xsl:stylesheet>

</ui:fragment>
