<?xml version="1.0" encoding="UTF-8"?>
<x:xsl
   pageConfig="#{PageConfig.display}"
   xmlns:x="http://www.dcm4che.org/xero/jsf"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:m="http://www.dcm4che.org/xero/metadata/display"
   xmlns:c="http://java.sun.com/jstl/core"
   m:xsl="imageXsl.xsl"
   m:docName="/documents/images"
   m:Display.script="ImageEvent.js"
   m:Display.script.priority="950"
   m:WL.script="windowLevel.js"
   m:WL.script.priority="50"
   m:WL.toolbar="wlToolbar"
   m:Event.script="/xero/js/Events.js"
   m:Event.script.priority="1000"
   m:jsEnabled.inherit="jsEnabled"
   m:trace.script="/xero/trace/trace.js"
>

<ui:fragment>
<x:template name="contentTypeMeta" m:Display.meta="contentTypeMeta" m:Display.meta.priority="25">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=UTF-8"/>
</x:template>
</ui:fragment>

<x:template name="display.debug" m:Debug.body="display.debug" m:Debug.body.priority="100">
  <xsl:if test="/documents/debug='true'">
  </xsl:if>
</x:template>

<!-- Declare the VML template and style information if IE -->
<x:template name="vmlDeclare" m:vml.script="vmlDeclare">
 <c:if test="#{browser=='MSIE'}">
  <style type="text/css">v\:* { behavior: url(#default#VML);   }</style>
 </c:if>
</x:template>

<x:template name="displayScriptVars" m:scriptVars.script="displayScriptVars" m:scriptVars.script.priority="-10">
    <xsl:element name="script">
      <xsl:attribute name="id">displayScriptVars</xsl:attribute>
      <xsl:attribute name="type">text/ecmascript</xsl:attribute>
var pageDebug=false;
<xsl:if test="/documents/debug='true'">
pageDebug=true;
</xsl:if>
var displayMode="<xsl:value-of select="/documents/mode" />";
    </xsl:element>
</x:template>
  
<x:template name="displayHtml" match="/"><html style="background: black; color: white; " xmlns="http://www.w3.org/1999/xhtml">
  <head>
	
    <x:callTemplates from="#{pageConfig}" mode="meta" />
    <title>Xero Image Frame</title>
    <x:callTemplates from="#{pageConfig}" mode="script" />
  </head>
  <body style="background: black; color: white;"
    onmousemove="return imageHandler.mouseMove(event);"
    onmouseout="return imageHandler.mouseOut(event);"
    onmouseup="return imageHandler.mouseUp(event);"
  >
   <form id="body" name="body" method="post" action="#">
    <xsl:if test="/documents/debug='true'">
     <button onclick="ttrace(document.getElementsByTagName('body')[0].innerHTML);">Body</button>
	 <button onclick="ttrace('Source='+displayXslt.asString(displayXslt.currentXml));">Source</button>
    </xsl:if>
    <x:callTemplates from="#{pageConfig}" mode="body" />
   </form>
  </body>
</html>
</x:template>

</x:xsl>
