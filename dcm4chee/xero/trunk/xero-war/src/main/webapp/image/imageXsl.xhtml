<?xml version="1.0" encoding="UTF-8"?>
<x:xsl
   pageConfig="#{PageConfig.display}"
   xmlns:x="http://www.dcm4che.org/xero/jsf"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
   xmlns:m="http://www.dcm4che.org/xero/metadata/display"
   m:xsl="imageXsl.xsl"
   m:docName="/documents/images"
   m:Display.script="ImageEvent.js"
   m:Display.script.priority="950"
   m:WL.script="windowLevel.js"
   m:WL.script.priority="50"
   m:WL.toolbar="wlToolbar"
   m:Event.script="../js/Events.js"
   m:Event.script.priority="1000"
   m:jsEnabled.inherit="jsEnabled"
>

<ui:fragment>
<x:template name="contentTypeMeta" m:Display.meta="contentTypeMeta" m:Display.meta.priority="25">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" xmlns="http://www.w3.org/1999/xhtml"/>
</x:template>
</ui:fragment>

<x:template name="display.debug" m:Debug.body="display.debug" m:Debug.body.priority="100">
  <xsl:if test="/documents/debug='true'">
     docName=<xsl:value-of select="$docName" /><br />
     imageUID=<xsl:value-of select="$imageUID" /> <br />
     imagePrevUID=<xsl:value-of select="$imagePrevUID" /><br />
     imageNextUID=<xsl:value-of select="$imageNextUID" /><br />
     imagePosition=<xsl:value-of select="$imagePosition" /><br />
     seriesViewable=<xsl:value-of select="$seriesViewable" /><br />
  </xsl:if>
</x:template>

<x:template name="displayScriptVars" m:scriptVars.script="displayScriptVars" m:scriptVars.script.priority="-10">
    <xsl:element name="script">
      <xsl:attribute name="id">displayScriptVars</xsl:attribute>
      <xsl:attribute name="type">text/ecmascript</xsl:attribute>
var studyUID="<xsl:value-of select="$studyUID" />";
var seriesUID="<xsl:value-of select="$seriesUID" />";
var imageUID="<xsl:value-of select="$imageUID" />";
var pageDebug=false;
<xsl:if test="/documents/debug='true'">
pageDebug=true;
</xsl:if>
var displayMode="<xsl:value-of select="/documents/mode" />";
    </xsl:element>
</x:template>
  
<x:template name="displayHtml" match="/"><html style="background: black; color: white; ">
  <head>
    <x:callTemplates from="#{pageConfig}" mode="meta" />
    <title>Xero Image Frame</title>
    <x:callTemplates from="#{pageConfig}" mode="script" />
  </head>
  <body style="background: black; color: white;"
    onmousemove="return imageHandler.mouseMove(event);"
    onmouseout="return imageHandler.mouseOut(event);"
    onmouseup="return imageHandler.mouseUp(event);"
  >
   <div id="body">
    <x:callTemplates from="#{pageConfig}" mode="body" />
    <div id="debug">Debug info</div> <br />
    <div id="debugAjax">Debug AJAX</div>
   </div>
  </body>
</html>
</x:template>

</x:xsl>
