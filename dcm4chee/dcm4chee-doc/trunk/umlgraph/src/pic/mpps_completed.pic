.PS
boxwid=1.2

copy "sequence.pic";

# Object definition
actor(M,"Modality");
object(S,"DICOM Server");
object(P,"MPPS SCP");
object(W,"MWL SCP");
object(U,"MPPS SCU");
object(I,"IAN SCU");
object(T,"MPPS2ORM");
object(H,"HL7Send");
actor(O,"Order Filler");
step();
active(S);
step();

# Modality Procedure Step Completed
active(M);
message(M,S,"N-SET(mpps)");
active(S);
message(S,P,"handle(mpps)");
inactive(S);
inactive(M);
active(P);
message(P,W,"*update(COMPLETED)");
active(W);
step();
inactive(W);
message(P,U,"notify(mpps)");
active(U);
async();
message(U,U,"*queue(mpps)");
sync();
active(U);
message(U,O,"N-SET(mpps)");
inactive(U);
inactive(U);
active(O);
step();
inactive(O);
message(P,T,"notify(mpps)");
active(T);
message(T,H,"forward(orm)");
active(H);
inactive(T);
async();
message(H,H,"*queue(orm)");
sync();
active(H);
message(H,O,"ORM^O01(CM)");
inactive(H);
inactive(H);
active(O);
step();
inactive(O);
message(P,I,"notify(mpps)");
inactive(P);
active(I);
lconstraint(I,"{all objects received}");
async();
message(I,I,"*queue(ian)");
active(I);
sync();
message(I,O,"{IAN supported}N-CREATE(ian)");
active(O);
message(I,O,"{only SCN supported}C-STORE(scn)");
inactive(I);
inactive(I);
step();
inactive(O);
step();

# Object lifeline completion
complete(I);
complete(U);
complete(S);
complete(T);
complete(O);
complete(M);
complete(P);
complete(W);
complete(H);

.PE
