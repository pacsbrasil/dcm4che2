<?xml version="1.0" encoding="UTF-8"?>
<chapter id="dcm4che-utilities" revision="1">
  <title>dcm4che2 DICOM Toolkit Utilities</title>

  <sect1 id="utilities-overview" revision="1">
    <title>Overview</title>

    <para>The base dcm4che toolkit contains a number of useful sample
    applications that may be used in conjunction with dcm4chee, with another
    archive application, or to operate on DICOM objects in a standalone
    fashion.</para>

    <para>The latest version of dcm4che is 2.0.6 within the
    dcm4che2 CVS code line. dcm4che2 is the next generation of the toolkit, replacing 
    dcm4che14.  dcm4che14 is still used within dcm4chee, but that will soon change.
    </para>

    <para>The dcm4che2 samples are a great place to get started with the
    toolkit if you are interested in writing your own DICOM applications as
    well. They demonstrate most of the operations that you will have need
    of.</para>

    <para>In order to start using the samples, you must first download the
    distribution from SourceForge. 
    To begin:</para>

    <orderedlist>
      <listitem>
        <para>Download the binary distribution of dcm4che2 from the Files
        page of the dcm4che project page on SourceForge (<literal><ulink
        url="http://sourceforge.net/projects/dcm4che/">http://sourceforge.net/projects/dcm4che/</ulink></literal>).
        The current version available for download is
        <literal>dcm4che-2.0.6.tar.bz2</literal>. If you plan on writing your own
        DICOM applications, it is recommended that you download the source
        distribution as well. The source may then be linked in with your IDE
        for debugging and browsing purposes.</para>
      </listitem>

      <listitem>
        <para>Extract the archive file to the directory of your choice.</para>
      </listitem>
    </orderedlist>
    
    <para>After extracting the contents, you should see the following directory structure:</para>
    
    <programlisting><![CDATA[
dcm4che-2.0.6
|
|_bin
|
|_dtd
|
|_etc
    |
    |_dcmof
    |
    |_logger
|
|_lib
|
|_xml
    ]]></programlisting>
    
        <para>This directory listing may be described as follows:</para>

        <variablelist spacing="compact">
            <varlistentry>
                <term>dcm4che-2.0.6</term>
                <listitem>
                    <para>
                        This is the root directory, named by "dcm4che" and the version.  It doesn't 
                        contain anything other than the following subdirectories.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>bin</term>
                <listitem>
                    <para>
                        The <literal>bin</literal> directory contains Unix and Windows scripts to run the sample applications.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>dtd</term>
                <listitem>
                    <para>
                        The <literal>dtd</literal> directory contains DTD files which define the XML format of the DICOM data
                        dictionary used by dcm4che2, and the XML format of DICOM objects
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>etc</term>
                <listitem>
                    <para>
                        The <literal>etc</literal> directory contains configuration used by the sample applications.  There are a
                        couple of subdirectories as well:
                        <itemizedlist>
                            <listitem>dcmof - information used by the Order Filler samples, currently only a sample Modality Worklist
                                            (MWL) Item (in XML format for submission to dcm4chee) resides here</listitem>
                            <listitem>logger - a sample log4j.properties file which defines a syslog appender.</listitem>
                        </itemizedlist>
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>lib</term>
                <listitem>
                    <para>
                        The <literal>lib</literal> directory contains the dcm4che2 libraries, all of the third party libraries that the toolkit 
                        depends upon, and individual JAR files for all of the samples.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>xml</term>
                <listitem>
                    <para>
                        The <literal>xml</literal> directory contains the XML definition of the DICOM data dictionary, and the DICOM UIDs
                        that the toolkit will use.  These items are inclusive of the DICOM 2006 standard, and are actually generated from 
                        the standard documents during the build process.
                    </para>
                </listitem>
            </varlistentry>
        </variablelist>

    </sect1>
    
    <sect1 id="utilities-usage" revision="1">
        <title>Basic Usage</title>
        
        <para>Using the dcm4che2 utilities and samples.</para>
        
        <sect2 id="dcm2txt">
            <title>dcm2txt</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcm2xml">
            <title>dcm2xml</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcmecho">
            <title>dcmecho</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcmgpwl">
            <title>dcmgpwl</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcmmwl">
            <title>dcmmwl</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcmof">
            <title>dcmof</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcmqr">
            <title>dcmqr</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="dcmrcv">
            <title>dcmrcv</title>
            <para>
                This application implements a DICOM server listening on a specified <literal>PORT</literal> for incoming association
                requests. If no local IP address of the network interface is specified
                connections on any/all local addresses are accepted. If an <literal>AET</literal> is specified,
                only requests with a matching called AE title will be accepted.
            </para>
            
            <para>Usage:</para>
            
            <para>
                <literal><![CDATA[
                    dcmrcv [Options] [<aet>[@<ip>]:]<port>
                ]]></literal>
            </para>
            
            <para><literal>dcmrcv DCMRCV:11112 --dest /tmp</literal></para>
            
            <para>Starts the server listening on port 11112, accepting association requests
                with DCMRCV as the called AE title. Received objects are stored to <literal>/tmp</literal>.</para>

            <para>Options (overrides presets defined in resource <literal>dcmrcv.cfg</literal>):</para>
            
            <programlisting><![CDATA[
 -soclosedelay <in millis>   delay in ms for Socket close after sending A-ABORT,
                      50ms by default
 -releaseTO <in millis>      timeout in ms for receiving A-RELEASE-RP, 5s by
                                        default
 -requestTO <in millis>      timeout in ms for receiving -ASSOCIATE-RQ, 5s by default
 -idleTO <in millis>         timeout in ms for receiving DIMSE-RQ, 60s by default
 -reaper <in millis>         period in ms to check for outstanding DIMSE-RSP, 10s
                                       by default
 -rspdelay <in millis>       delay in ms for DIMSE-RSP; useful for testing
                                        asynchronous mode
 -pdv1                send only one PDV in one P-Data-TF PDU, pack command
                      and data PDV in one P-DATA-TF PDU by default.
 -sndpdulen <KB>      maximal length in KB of sent P-DATA-TF PDUs, 16KB by
                      default
 -rcvpdulen <KB>      maximal length in KB of received P-DATA-TF PDUs,
                      16KB by default
 -V,--version         print the version information and exit
 -async <maxops>      maximum number of outstanding operations performed
                      asynchronously, unlimited by default.
 -bigendian           accept also Explict VR Big Endian transfer syntax.
 -bufsize <KB>        minimal buffer size to write received object to
                      file, 1KB by default
 -defts               accept only default transfer syntax.
 -dest <dir>          store received objects into files in specified
                      directory <dir>. Do not store received objects by default.
 -h,--help            print this message
 -native              accept only transfer syntax with uncompressed pixel
                      data.
 -sorcvbuf <KB>       set SO_RCVBUF socket option to specified value in KB
 -sosndbuf <KB>       set SO_SNDBUF socket option to specified value in KB
 -tcpdelay            set TCP_NODELAY socket option to false, true by
                      default
            ]]></programlisting>
        </sect2>
        
        <sect2 id="dcmsnd">
            <title>dcmsnd</title>
            <para>
                This application acts as a Storage SCU to send DICOM objects to a Storage SCP. 
                It loads composite DICOM Object(s) from specified DICOM file(s) or a directory structure and sends them to
                the specified remote Application Entity. If a directory is specified, all DICOM
                objects in files under that directory and further sub-directories are sent.
                If <literal>PORT</literal> is not specified, DICOM default port 104 is assumed. If no
                 <literal>HOST</literal> is specified, localhost is assumed.
            </para>
            
            <para>Usage:</para>
            
            <para>
                <literal><![CDATA[
                    dcmsnd [Options] <aet>[@<host>[:<port>]] <file>|<directory>...</literal></para>
                ]]></literal>
            </para>
            
            <para>Examples:</para>
            
            <para><literal>dcmsnd DCMRCV@localhost:11112 image.dcm</literal></para>
            
            <para>Opens association to local server, listening on port 11112 with called application entity title 
            <literal>DCMRCV</literal>. Sends the DICOM file <literal>image.dcm</literal> to the
                server.</para>
                        
            <para>Options (overrides presets defined in resource <literal>dcmsnd.cfg</literal>):</para>
                <programlisting><![CDATA[
 -soclosedelay <in millis>   delay in ms for Socket close after sending A-ABORT,
                                          50ms by default
 -acceptTO <in millis>       timeout in ms for receiving A-ASSOCIATE-AC, 5s by
                                        default
 -releaseTO <in millis>      timeout in ms for receiving A-RELEASE-RP, 5s by
                                        default
 -reaper <in millis>         period in ms to check for outstanding DIMSE-RSP, 10s
                                        by default
 -rspTO <in millis>          timeout in ms for receiving DIMSE-RSP, 60s by
                      default
 -lowprior            LOW priority of the C-STORE operation, MEDIUM by
                      default
 -highprior           HIGH priority of the C-STORE operation, MEDIUM by
                      default
 -pdv1                send only one PDV in one P-Data-TF PDU, pack command
                      and data PDV in one P-DATA-TF PDU by default.
 -sndpdulen <KB>      maximal length in KB of sent P-DATA-TF PDUs, 16KB by
                      default
 -rcvpdulen <KB>      maximal length in KB of received P-DATA-TF PDUs,
                      16KB by default
 -L <aet[@host]>      set AET and local address of local Application
                      Entity, use ANONYMOUS and pick up any valid local address to bind the
                      socket by default
 -V,--version         print the version information and exit
 -async <maxops>      maximum number of outstanding operations it may
                      invoke asynchronously, unlimited by default.
 -bufsize <KB>        transcoder buffer size in KB, 1KB by default
 -connectTO <in millis>      timeout in ms for TCP connect, no timeout by default
 -h,--help            print this message
 -sorcvbuf <KB>       set SO_RCVBUF socket option to specified value in KB
 -sosndbuf <KB>       set SO_SNDBUF socket option to specified value in KB
 -tcpdelay            set TCP_NODELAY socket option to false, true by
                      default
                    ]]></programlisting>
                
        </sect2>
        
        <sect2 id="dcmwado">
            <title>dcmwado</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="jpg2dcm">
            <title>jpg2dcm</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="logger">
            <title>logger</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="mkelmdic">
            <title>mkelmdic</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="mkuiddic">
            <title>mkuiddic</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="mkvrmap">
            <title>mkvrmap</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="pdf2dcm">
            <title>pdf2dcm</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="rgb2ybr">
            <title>rgb2ybr</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="txt2dcmsr">
            <title>txt2dcmsr</title>
            <para>
                TODO
            </para>
        </sect2>
        
        <sect2 id="xml2dcm">
            <title>xml2dcm</title>
            <para>
                TODO
            </para>
        </sect2>
        
    </sect1>
</chapter>