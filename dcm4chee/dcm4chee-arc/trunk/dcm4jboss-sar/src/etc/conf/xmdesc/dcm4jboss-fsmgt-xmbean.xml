<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mbean PUBLIC
   "-//JBoss//DTD JBOSS XMBEAN 1.1//EN"
   "http://www.jboss.org/j2ee/dtd/jboss_xmbean_1_1.dtd">

<mbean>
   <description>File System Management Service</description>

   <descriptors>
      <persistence persistPolicy="OnUpdate"/>
      <persistence-manager value="org.jboss.mx.persistence.DelegatingPersistenceManager" />
   </descriptors>

   <class>org.dcm4chex.archive.mbean.FileSystemMgtService</class>

   <constructor>
      <description>The default constructor</description>
      <name>FileSystemMgtService</name>
   </constructor>

   <!-- Attributes -->
   <attribute access="read-write"
      getMethod="getDirectoryPathList"
      setMethod="setDirectoryPathList">
      <description>List directories/mount points on this DICOM Node.
      Use ';' on Windows and ':' on Unix-like platforms to separate
      multiple directory path names. Relative path names are
      resolved relative to INSTALL_DIR/server/pacs/. '*'-suffix marks current 
      Storage Directory used for storage of new received DICOM Instances by the
      Storage SCP on this DICOM Node.      
      </description>
      <name>DirectoryPathList</name>
      <type>java.lang.String</type>
      <descriptors>
         <value value="archive*" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getRetrieveAET"
      setMethod="setRetrieveAET">
      <description>Retrieve AET associated with this DICOM Node. 
      </description>
      <name>RetrieveAET</name>
      <type>java.lang.String</type>
      <descriptors>
         <value value="PACS_TIANI" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getHighWaterMark"
      setMethod="setHighWaterMark">
      <description>High Water Mark in MB(=1000000 Bytes).
      Storage Directory switches to next entry in DirectoryPathList,
      if amount of available disk space falls below this value.      
      </description>
      <name>HighWaterMark</name>
      <type>int</type>
      <descriptors>
         <value value="50" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getMountFailedCheckFile"
      setMethod="setMountFailedCheckFile">
      <description>Existence of specified file signals failed mount.
      </description>
      <name>MountFailedCheckFile</name>
      <type>java.lang.String</type>
      <descriptors>
         <value value="NO_MOUNT" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="isMakeStorageDirectory"
      setMethod="setMakeStorageDirectory">
      <description>Make Storage Directory if no one already exists.
      </description>
      <name>MakeStorageDirectory</name>
      <type>boolean</type>
      <descriptors>
         <value value="true" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getFreeDiskSpaceWaterMarkFactor"
      setMethod="setFreeDiskSpaceWaterMarkFactor">
      <description>Factor to calculate High Water Mark for freeDiskSpace.
      freeDiskSpace starts with deletion if currAvail &lt; minAvail.
      currAvail = Available space of all defined filesystems.
      minAvail = highWaterMark * freeDiskSpaceWaterMarkFactor * nrOfFileSystems.
      </description>
      <name>FreeDiskSpaceWaterMarkFactor</name>
      <type>float</type>
      <descriptors>
         <value value="1.5" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getStopFreeDiskSpaceWaterMarkFactor"
      setMethod="setStopFreeDiskSpaceWaterMarkFactor">
      <description>Factor to calculate High Water Mark indicating the end of the FreeDiskSpace process.
      The FreeDiskSpace process works until current available space exceeds this value.
      </description>
      <name>StopFreeDiskSpaceWaterMarkFactor</name>
      <type>float</type>
      <descriptors>
         <value value="2.0" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getFreeDiskSpaceNotAccessedForDays"
      setMethod="setFreeDiskSpaceNotAccessedForDays">
      <description>The number of days a study must not be accessed for freeDiskSpace.
      This value is used if the  freeDiskSpaceWaterMark is not reached to delete the files of studies
      that not accessed in the given time.
      </description>
      <name>StudiesNotAccessedForDays</name>
      <type>int</type>
      <descriptors>
         <value value="365" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="isFlushStudiesOnMedia"
      setMethod="setFlushStudiesOnMedia">
      <description>This policy checks if a study is stored on a media (offline storage)
      </description>
      <name>FlushStudiesOnMedia</name>
      <type>boolean</type>
      <descriptors>
         <value value="true" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="isFlushStudiesExternalRetrievable"
      setMethod="setFlushStudiesExternalRetrievable">
      <description>This policy checks if a study is external retrievable.
      </description>
      <name>FlushStudiesExternalRetrievable</name>
      <type>boolean</type>
      <descriptors>
         <value value="false" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="isDeleteStudiesUnconditional"
      setMethod="setDeleteStudiesUnconditional">
      <description>If this policy is active, the oldest studies will be deleted immediately!
      Deletes both files and database entries!
      Enable this policy only if archive is used only as caching system!
      </description>
      <name>DeleteStudiesUnconditional</name>
      <type>boolean</type>
      <descriptors>
         <value value="false" />
      </descriptors>
   </attribute>
   <attribute access="read-write"
      getMethod="getEjbProviderURL"
      setMethod="setEjbProviderURL">
      <description>Identifies JNDI (e.g: jnp://hostname:1099) with EJBs.
      "LOCAL", if EJBs are deployed in same JBoss instance.
      </description>
      <name>EjbProviderURL</name>
      <type>java.lang.String</type>
      <descriptors>
         <value value="LOCAL" />
      </descriptors>
   </attribute>
   &defaultAttributes;

   <!-- Operations -->
   &defaultOperations;
   <operation impact="INFO">
      <description>Determines if the specified File System is
      accessable on this DICOM Node</description>
      <name>isLocalFileSystem</name>
      <parameter>
        <description>Directory Path</description>
        <name>DirPath</name>
        <type>java.lang.String</type>
      </parameter>
      <return-type>boolean</return-type>
   </operation>
   <operation impact="INFO">
      <description>Show Available Disk Space on Local File Systems</description>
      <name>showAvailableDiskSpace</name>
      <return-type>java.lang.String</return-type>
   </operation>
   <operation impact="INFO">
      <description>Select Storage File System with Available Disk Space 
      &gt; High Water Mark</description>
      <name>selectStorageFileSystem</name>
      <return-type>org.dcm4chex.archive.mbean.FileSystemInfo</return-type>
   </operation>
   <operation impact="ACTION">
      <description>Purge unreferenced Files</description>
      <name>purgeFiles</name>
      <return-type>void</return-type>
   </operation>   
   <operation impact="INFO">
      <description>Locate SOP Instance. Return a File object, if the instance
      is locally available, or the hostname as String object if a file
      of the instance is located on another host.</description>
      <name>locateInstance</name>
      <parameter>
        <description>SOP Instance UID</description>
        <name>iuid</name>
        <type>java.lang.String</type>
      </parameter>
      <return-type>java.lang.Object</return-type>
   </operation>
   <operation impact="ACTION">
      <description>Check if it is necessary to free disk space.
      </description>
      <name>isFreeDiskSpaceNecessary</name>
      <return-type>boolean</return-type>
   </operation>   
   <operation impact="ACTION">
      <description>Free disk space by deleting old studies.
      Deletes all older files on study level that fullfill the freeDiskSpacePolicy.
      </description>
      <name>freeDiskSpace</name>
      <return-type>long</return-type>
   </operation>   
   
</mbean>
